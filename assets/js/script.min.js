
 
$(document).on('click', 'a.js-link', scrollToLink);
$(document).on('click', 'a.js-link-top', scrollToLink);

function scrollToLink() {
    $("html, body").animate({
        scrollTop: $($(this).attr("href")).offset().top - 40 + "px"
    }, {
        duration: 400,
        easing: "swing"
        });
    return false;
}
// js-form-service
$('*[data-service]').click( function(e) {  
    $('#js-form-service')[0].value = $(e.currentTarget).attr('data-service')
})
 
// header btn click function
$(document).ready(function () {
    $("a.js-link").click(function (e) {
        e.preventDefault(); 
        $('.navbar-collapse.show').collapse('hide');
        $('.js-navbar-toggle span').toggleClass('d-none')
    $('.js-navbar-toggle svg').toggleClass('d-none') 
    });
});
      
$('.js-navbar-toggle').click( headerBtnTimes)

function headerBtnTimes() { 
  $('.js-navbar-toggle span').toggleClass('d-none')
  $('.js-navbar-toggle svg').toggleClass('d-none')
}
 
$('#myModal').on('shown.bs.modal', function () {
    $('#myInput').trigger('focus')
})
 
    new Selectr('#yourcity', { 
        searchable: false
    }); 


    // Эти плагины инициализируются в vue  приложении

    // new Selectr('.priceSelect', { 
    //     searchable: false
    // }); 
 
   
    // var swiper = new Swiper('.swiper-container', {
    //     loop: false,
    //     slidesPerView: 6,   
    //     spaceBetween: 30,
    //     grubCursor: true, 
    //     scrollbar: {
    //         el: '.swiper-scrollbar',
    //         hide: false,
    //         dragSize: 135
    //     },
    //     breakpoints: {
    //         // when window width is >= 320px
    //         320: {
    //         slidesPerView: 2,
    //         spaceBetween: 10,
    //         scrollbar: { 
    //             dragSize: 25
    //         },
    //         },
    //         // when window width is >= 480px
    //         576: {
    //         slidesPerView: 3,
    //         spaceBetween: 10
    //         },
    //         // when window width is >= 640px
    //         998: {
    //             slidesPerView: 6,   
    //             spaceBetween: 30,
    //         }
    //     }
    // });
var app = new Vue({
    el: '#app',
    computed: { 
        productPrice: function () { 
            return 0.1
        } ,  
    },
    data() {
       return {   
        products: [ 
            {
                id: 1,
                name: 'MacBook Pro', 
                year: 2010,
                factor: 0,
                url: 'mac2010.png'
            }, 
            {
                id: 2,
                name: 'MacBook Pro  ', 
                year: 2012,
                factor: 0.1,
                url: 'mac2012.png'
            }, 
            {
                id: 3,
                name: 'MacBook Pro  ', 
                year: 2015,
                factor: 0.2,
                url: 'mac2015.png'
            }, 
            {
                id: 4,
                name: 'MacBook Pro ', 
                year: 2017,
                factor: 0.3,
                url: 'mac2017.png'
            }, 
            {
                id: 5,
                name: 'MacBook Pro  ', 
                year: 2019,
                factor: 0.4,
                url: 'mac2019.png'
            }, 
            {
                id: 6,
                name: 'MacBook Pro  ', 
                year: 2020,
                factor: 0.5,
                url: 'mac2020.png'
            }, 
            {
                id: 7,
                name: 'MacBook Air ', 
                year: 2009,
                factor: 0,
                url: 'macAir2009.png'
            }, 
            {
                id: 8,
                name: 'MacBook Air ', 
                year: 2012,
                factor: 0.1,
                url: 'macAir2012.png'
            }, 
            {
                id: 9,
                name: 'MacBook Air ', 
                year: 2015,
                factor: 0.2,
                url: 'macAir2015.png'
            }, 
            {
                id: 10,
                name: 'MacBook Air ', 
                year: 2017,
                factor: 0.3,
                url: 'macAir2017.png'
            }, 
            {
                id: 11,
                name: 'MacBook Air ', 
                year: 2020,
                factor: 0.5,
                url: 'macAir2020.png'
            }, 
           
        ],

        services: [
            {   
                id: 1,
                name: 'Переустановка macOS',
                description: 'Переустановка macOS без учета стоимости элементов',
                startedPrice: 595, 
                activePrice: 595, 
                time: 'от 1 часа', 
                classActive: false
            },
            {
                id: 2,
                name: 'Замена и ремонт дискретных элементов',
                description: 'Замена и ремонт дискретных элементов без учета стоимости элементов',
                startedPrice: 495, 
                activePrice: 495, 
                time: 'от 1,5 часа', 
                classActive: false
            },
            { 
                id: 3,
                name: 'Замена и ремонт клавиатуры',
                description: 'Замена и ремонт клавиатуры без учета стоимости клавиатуры',
                startedPrice: 495, 
                activePrice: 495, 
                time: 'от 30 минут', 
                classActive: false
            },
            {
                id: 4,
                name: 'Замена и ремонт интегрированных элементов ',
                description: 'Замена и ремонт интегрированных элементов на материнской плате без учета стоимости элементов',
                startedPrice: 595, 
                activePrice: 595, 
                time: 'от 1 часа', 
                classActive: false
            },
            {
                id: 5,
                name: 'Замена оперативной памяти',
                description: 'Замена  оперативной памяти без учета стоимости оперативной памяти',
                startedPrice: 495, 
                activePrice: 495, 
                time: 'от 30 минут', 
                classActive: false
            },
            {
                id: 6,
                name: 'Замена порта USB',
                description: 'Замена порта USB без учета стоимости элементов',
                startedPrice: 495, 
                activePrice: 495, 
                time: 'от 1,5 часа', 
                classActive: false
            },
            {
                id: 7,
                name: 'Замена разъема питания',
                description: 'Замена разъема питания без учета стоимости элементов',
                startedPrice: 495, 
                activePrice: 495, 
                time: 'от 1,5 часа', 
                classActive: false
            },
            {
                id: 8,
                name: 'Замена термопасты',
                description: 'Замена термопасты',
                startedPrice: 445, 
                activePrice: 445, 
                time: 'от 40 минут', 
                classActive: false
            },
            {
                id: 9,
                name: 'Замена wi-fi модуля',
                description: 'Замена  wi-fi модуля',
                startedPrice: 495, 
                activePrice: 495, 
                time: 'от 1,5 часа', 
                classActive: false
            }, 
            {
                id: 10,
                name: 'Починка и замена матрицы',
                description: 'Починка и замена матрицы без учета стоимости элементов',
                startedPrice: 595, 
                activePrice: 595, 
                time: 'от 1 часа', 
                classActive: false
            },
            {
                id: 11,
                name: 'Починка и замена разъемов',
                description: 'ЗПочинка и замена разъемов без учета стоимости разъемов',
                startedPrice: 495, 
                activePrice: 495, 
                time: 'от 1 часа', 
                classActive: false
            },
            {
                
                id: 12,
                name: 'Починка и замена шлейфа матрицы',
                description: 'Замена и ремонтшлейфа матрицы',
                startedPrice: 595, 
                activePrice: 595, 
                time: 'от 1,5 часа', 
                classActive: false
            },
            {
                id: 13,
                name: 'Починка и чистка системы охлаждения',
                description: 'Починка и чистка системы охлаждения',
                startedPrice: 595, 
                activePrice: 595, 
                time: 'от 1 часа', 
                classActive: false
            },
            {
                id: 14,
                name: 'Починка и замена видеокарты ',
                description: 'Замена и ремонт видеокарты',
                startedPrice: 595, 
                activePrice: 595, 
                time: 'от 40 минут', 
                classActive: false
            },
            {
                id: 15,
                name: 'Починка лампы подсветки матрицы',
                description: 'Починка лампы подсветки матрицы без учета стоимости элементов',
                startedPrice: 595, 
                activePrice: 595, 
                time: 'от 1 часа', 
                classActive: false
            },
             
        ],
       
        isActiveProduct: 1,

        formServices: '', 
        formPriceSum: 0,
        changedServices: [],  
        changedProduct:  {
                id: 1,
                name: 'MacBook Pro', 
                year: 2010,
                factor: 0,
                url: 'mac2010.png'
            }
       }
    }, 
    methods: { 
        setActiveProduct(product) { 
            this.changedProduct = product 
            this.isActiveProduct = this.changedProduct.id  
            for(let i = 0; i<this.changedServices.length; i++) { 
                this.changedServices[i].classActive = false 
            }
            this.changedServices = []
            this.formPriceSum = 0

            this.setActualPrices(this.changedProduct.factor)
            this.setFormServices()
        },
        setActiveServices(id) {  
            for(let i = 0; i<this.changedServices.length; i++) {  
                if(this.changedServices[i].id === id) {  
                    this.changedServices[i].classActive = false 
                    this.changedServices.splice(i, 1) 
                    this.setFormServices()
                    this.setFormPriceSum()
                    return false
                }  
            }
            this.changedServices.push(this.services[id - 1])  
            this.services[id - 1].classActive = true     

            this.setFormServices()
            this.setFormPriceSum()
        },  
        setActualPrices(factor) {
            for(let i = 0; i<this.services.length; i++) {   
                
                let newPrice =  (Math.round( ( (factor * this.services[i].startedPrice ) + this.services[i].startedPrice  ) / 10  ) * 10) - 5   

                // окрушление до сотен вверх 
                // let newPrice =  (Math.ceil( ( (factor * this.services[i].startedPrice ) + this.services[i].startedPrice  ) / 100  ) * 100) - 5
                
                this.services[i].activePrice = newPrice
            }
        }, 
        setFormServices() { 
            let servicesString = ''
            for(let i = 0; i< this.changedServices.length; i++) {  
                servicesString += this.changedServices[i].name + ', '
            }
            this.formServices = servicesString 
        }, 
        setFormPriceSum() { 
            let priceSum = 0
            for(let i = 0; i< this.changedServices.length; i++) {  
                priceSum += this.changedServices[i].activePrice 
            }
            this.formPriceSum = priceSum 
        }, 

        
    },
    mounted() { 
         
        var swiper = new Swiper('.swiper-container', {
            loop: false,
            slidesPerView: 2,   
            spaceBetween: 10,
            grubCursor: true, 
            scrollbar: {
                el: '.swiper-scrollbar',
                hide: false,
                dragSize: 135
            },
            breakpoints: {
                // when window width is >= 320px
                320: {
                slidesPerView: 2,
                spaceBetween: 10,
                scrollbar: { 
                    dragSize: 50
                },
                },
                // when window width is >= 480px
                576: {
                slidesPerView: 3,
                spaceBetween: 10
                },
                // when window width is >= 640px
                998: {
                    slidesPerView: 6,   
                    spaceBetween: 30,
                }
            }
        });

        if( $(document).innerWidth() > 992 )  {
            $('.mac-price_form').css('min-height', $('.mac-price_block').innerHeight() - 4 )
        }
 
       
    }
})

// header sticty function
$(window).scroll(setScrollHeader);

$(window).on('load', setScrollHeader)

function setScrollHeader() {
    if ($(this).scrollTop() > 1){  
        $('header').addClass("sticky");
    }
    else{
        $('header').removeClass("sticky");
    }
}